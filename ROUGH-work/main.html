<!doctype html>
 <html >
 <head>
  <title>IIT(ISM)Dhanbad_collegePetition Website</title>
  <link rel="image_src" href="https://www.petitions.net/images/petition4.jpg">
  <script>
    var timerStart = Date.now();
    var cookie_consent_modal_shown = false;
    var visitor_gave_consent_for_cookies_during_this_page_view = false;
    var datetime_one_year_from_this_day_international_format = '2022-03-29 07:38:08';
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">  
  </script> -->
   
  <script src="C:\xampp\htdocs\web\college_petition_web\ROUGH-work/ad_blocker.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap-social/5.0.0/bootstrap-social.css" as="style" onload="this.rel='stylesheet'">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  
  <script>
    /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
    !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
    /*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */
    !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);

  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" async=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inview/1.0.0/jquery.inview.min.js" async=""></script>
  <script>
    var adsense_page_level_ads_enabled = false;
  </script>
 </head>
 <body>
   <script>
     if (1==2 && top.location != location) { top.location.href = document.location.href; }

      /*//var tzo=(new Date()).getTimezoneOffset().toString();
        var tzo=(new Date().getTimezoneOffset()/60)*(-1);
        alert(tzo);*/


     var DEBUG_MODE_ON = 0;
     var http_method = 'get';
     var current_page_type = 'home page';
     var show_adsense_ads = 0;
     var petitions_promoted_by_other_users = "Petitions promoted by other users";

     if (!DEBUG_MODE_ON) {
      console = console || {};
      console.log = function(){};
       }
    
    

     $(document).ready(
       function(){
    
 
        //   $('[data-toggle="tooltip"]').tooltip();   

        //$('[data-toggle="tooltip"]').tooltip(); 
   

        // voisi laittaa ehdoksi tälle, että ikkunan koko pitää olla riittävän suuri, että käytetään fixed-arvoa

        //alert($(window).height());



        var timezone = ''; // jstz.determine();
             //alert(timezone.name());

             // Build the expiration date string:
        var expiration_date = new Date();
        var cookie_string = '';
        expiration_date.setFullYear(expiration_date.getFullYear() + 1);
            // Build the set-cookie string:
           //cookie_string = "testing_if_javascript_works=1; path=/; expires=" + expiration_date.toGMTString(); // " + timezone.name() + "
    
        cookie_string = "testing_if_javascript_works=1; path=/; expires=0"; // " + timezone.name() + "

           // Create/update the cookie:
        document.cookie = cookie_string;
     });
    </script>
    <nav class="navbar navbar-light navbar-expand-lg navbar-custom">
      <a class="navbar-brand" href="/"><i class="fas fa-home"></i>IIT(ISM) DHANBAD_COLLEGE PETITION</a>
                  
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        
        <ul class="navbar-nav mr-auto">
     
          <li class="nav-item ">
            <a class="nav-link" href="start-petition.html"><i class="far fa-edit"></i> Start a Petition</a>
          </li>
          <li class="nav-item "><a class="nav-link" href="/browse.php?order_by=petition_created&amp;page=1">Most Recent Petitions</a></li>
          <li class="nav-item "><a class="nav-link" href="contact.html"><i class="far fa-envelope"></i> Contact Us</a></li>
                    
        </ul>
        
          
     
        <form action="/search.php" id="cse-search-box" class="form-inline">
           <div class="input-group">
              <input class="form-control" type="search" placeholder="Petition name" aria-label="Search" name="q" size="25" value="">
              <input type="hidden" name="cx" value="016684359365531315885:yey2o-v2qv4">
              <input type="hidden" name="cof" value="FORID:9">
              <input type="hidden" name="ie" value="UTF-8">
                            
              <div class="input-group-append">
              <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i></button>
              </div>
           </div>
        </form>
           
      </div>
      
    </nav>
    <div id="container2" class="container-fluid">

      <div class="row">
      <script>
          var authenticity_token = 'f06348d56d97227c4c6938bf05c1c76f';
          var page_view_id;
           var num_sessions = 1;
      </script></div>
       <div class="row"> 
        <div class="col-sm-4">
           <img src="C:\xampp\htdocs\web\college_petition_web\ROUGH-work/petition4.jpg" style="padding-right: 0.5em; padding-bottom: 0.5em;">
         </div>
        <div class="col-sm-8">
                                                                           
           <h1><b>Welcome to IIT(ISM) DHANBAD's Online Petition Writing & Voting Platform</b></h1>
           <br><br>           
           <h2>Lets raise our voice against the college policies !!</h2>
           <br><br> 
                              
                 <ul>
                   <li><h3><b>Create a petition</b></h3>
                   <a href="javascript:show_and_hide_element('how_to_start_petition', 'how_to_start_petition_link');" id="how_to_start_petition_link">
                   <i class="fas fa-info-circle"></i></a>
                   <span id="how_to_start_petition" style="display: none;">
                                  
                   <br><h4><b>Start a petition by completing a simple form and in a few minutes your petition is online.</b></h4>
                                  
                   <br><br><a class="btn btn-primary" href="start-petition.html">Create a petition</a>
                   </span></li>
                   <li><h3><b>Collect signatures</b></h3><a href="javascript:show_and_hide_element('how_to_collect_signatures', 'how_to_collect_signatures_link');" id="how_to_collect_signatures_link">
                   <i class="fas fa-info-circle"></i></a>
                   <ul id="how_to_collect_signatures" style="display: none;">
                   <h4>How to collect signatures?</h4>
                   <li><b>Share the petition on your Facebook wall and in groups related to the topic of your petition. Open the petition page and click the Facebook button to share the petition on Facebook.</b></li>
                   <li><b>Contact your friends</b>
                   <ol><li>Write a message where you explain why you have started the petition, since people are more likely to sign it if they understand how important the topic is.
                   </li><li>Copy and paste the URL of the petition into your message.</li>
                   <li>Send the message using email, SMS, Facebook, WhatsApp, Twitter, Skype, Instagram and LinkedIn.</li>
                   </ol>
                   </li>
                   </ul>
                   </li><li><h3><b>Create an active community around your petition</b></h3> <a href="javascript:show_and_hide_element('active_community', 'active_community_link')" id="active_community_link"><i class="fas fa-info-circle"> </i></a><span id="active_community" style="display: none;"><br>
                     It's common for people to sign a petition and then forget it. Don't let this happen with your petition. Creating change is not a one-man or one-woman show. Try to get people involved.
                   <ul>
                   <li>Publish announcements regularly to keep the signatories of your petition up to date on what has happened since you started the petition, and what will happen next. The signatories will be notified by email when you publish a new announcement.</li>
                   <li>Create a group on WhatsApp for the signatories to discuss the petition. Encourage people to participate by asking their opinions and ideas.</li>
                   </ul>
                   </span>
                   </li><li><h3><b>Deliver your petition to the decision makers</b></h3> <a href="javascript:show_and_hide_element('schedule_meeting', 'schedule_meeting_link')" id="schedule_meeting_link"><i class="fas fa-info-circle"> </i></a>
                   <span id="schedule_meeting" style="display: none;"><br><h4>A Petition would be send to the college authorities if the number of signatories increase above 500 within a week of particular petition publishing</h4></span></li>
                  </ul></div>
                  </div>
                     
      <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-body">
                  <img src="C:\xampp\htdocs\web\college_petition_web\ROUGH-work/sample-petition.png" class="img-responsive">
              </div>
          </div>
        </div>
      </div>
             
           
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link active" href="/browse.php?order_by=stats_signatures_last_30_days&amp;page_number=1">Most Popular Petitions</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/browse.php?order_by=petition_created&amp;page_number=1">Most Recent Petitions</a>
        </li>
     </ul>
      
      <div style="margin-top: 1em;padding-left: 2em; margin-bottom: 1em;">	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_all_time&amp;page_number=1">All time</a> | 	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_last_24_hours&amp;page_number=1">24 hours</a> | 	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_last_7_days&amp;page_number=1">7 days</a> | <b>30 days</b> | 	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_last_month&amp;page_number=1">Last month</a> | 	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_last_12_months&amp;page_number=1">12 months</a> | 	<a style="padding-bottom: 1em; padding-top: 1em;" href="/browse.php?order_by=stats_signatures_this_year&amp;page_number=1">This year (2021)</a>
      </div>
      
      <div id="footer" class="rounded_top">   
      <div id="petition_ads" class="petition_ads_list" style="display: none;"><h2>Petitions promoted by other users</h2><div class="row"><div class="col-sm-12"></div></div><div class="row"><div class="col-sm-12"></div></div></div>
      <div id="petition_ads2" style="display: none;">                
                                   
                
      </div><hr><h2 style="color: #000;">Is there something you want to change?</h2><p> Change doesn't happen by staying silent. Start a social movement by creating a petition.</p><a href="/start-petition" class="btn btn-primary"><i class="far fa-edit"></i> Start a petition of your own</a><div style="overflow: hidden;">
      
      <div id="advertisement" class="text-ad"></div>
                              
      <div id="test_element"></div><div id="users-device-size">
        <div id="xs" class="visible-xs"></div>
        <div id="sm" class="visible-sm"></div>
        <div id="md" class="visible-md"></div>
        <div id="lg" class="visible-lg"></div>
      </div>
      <script>
      function show_fb_comments(petition_id) {
         $('#fb_comments').toggle();
         }
      
      function open_fb_login_window(url) {
          console.log("Ollaan funktiossa open_fb_login_window");
          window.location.replace(url);
      
      /*
          var fb_login_window = window.open('', 'defaultWindow', "location=1,status=1,scrollbars=1,width=840,height=580");
          fb_login_window.document.write('<h2>Waiting response from Facebook...</h2>');
          fb_login_window.location.href = url;
      */
      }
      
      function show_sign_petition_form() {
          $('#petition_text').hide();
      }
      
      function hide_footer_sign_this_petition_button() {
          $('#footer_sign_this_petition_button').hide();
          return true;
      }
      
      function hide_footer_share_this_petition_button() {
        $('#footer_share_this_petition_button').hide();
        
        $('#sign').hide();
        $('#show_sign_form_button').show();
          return true;
      }
      
                
      function RefreshPage() { 
          //alert('child kutsui vanhempansa ikkunaa');         
              location.reload();
          //alert('jostain syystä sivun uudelleen lataus ei tuota tulosta');
      }
      
      function testi() {
          
      }
      
      function hide(elementID) {
        document.getElementById(elementID).style.visibility = 'hidden'; 
        
      }
      
      //function sleep(ms) {
       // return new Promise(resolve => setTimeout(resolve, ms));
     // }
      
      
      
      
      
      function show(elementID) {
        document.getElementById(elementID).style.visibility = 'visible'; 
      }
      
      function show_element(element_id) {
       $( "#" + element_id).show( "slow");    
      }
      
      function hide_element(element_id) {
       $( "#" + element_id).hide( "slow");    
      }    
      
      function openDefaultWindow(url) {
          var windowX = window.open(url, 'defaultWindow', "location=1,status=1,scrollbars=1,width=640,height=480");
      }
      
      function open_zaypay(id) {
          var windowX = window.open('http://www.zaypay.com/pay/' + id, '', "location=0,toolbar=0,status=0,scrollbars=0,width=555,height=415");
      }
      
      function fbs_click() {
          u=location.href;
          t=document.title;
          window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=626,height=436');
      }
      
      
      
      function fbs_click3(u, t) {
      
          window.open('http://www.facebook.com/sharer.php?u='+ u +'&t='+ t,'sharer','toolbar=0,status=0,width=626,height=436');
      }
      
      
      
      function fbs_click2() {
          u=location.href;
          t=document.title;
          window.open('http://www.facebook.com/groups/create.php','createGroup','toolbar=0,status=0,width=726,height=676');
      }      
      
      function show_removal_details(message_counter) {
          $("#" + message_counter + " ul.removal_details").toggle(500);
          //$("#139 ul.removal_details").toggle(500);
      }
      
      function is_valid_youtube_url(url) {
          //.*?([a-zA-Z0-9_-]{11}).*?
          var regexp = /https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i;
          regexp = /v=([a-zA-Z0-9\-_]{11})/;
          return regexp.test(url);
      }
                          
            
      var a_views = Array();
      var ads_viewed = Array();
      var a_campaigns = Array();
      var page_petition_id = 0;
      var processing_time_on_server_side = '37';
      var id_of_petition_shown_in_this_page = 0;
      
                  
       $(document).ready(function () {
       
          
      inView('#a_campaign_182130').once('enter', el => { track_ad_view(182130, 315006); } ).on('exit', el => {  });
      a_views[182130] = null;
      a_campaigns[1] = {
      id:"182130",
      petition_id:"315006"
      };
      inView('#a_campaign_181764').once('enter', el => { track_ad_view(181764, 315636); } ).on('exit', el => {  });
      a_views[181764] = null;
      a_campaigns[2] = {
      id:"181764",
      petition_id:"315636"
      };        
                        
      });
      
                         
      !function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.inView=e():t.inView=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var i=n(2),o=r(i);t.exports=o["default"]},function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=r(i),u=n(3),f=r(u),s=n(4),c=function(){if("undefined"!=typeof window){var t=100,e=["scroll","resize","load"],n={history:[]},r={offset:{},threshold:0,test:s.inViewport},i=(0,o["default"])(function(){n.history.forEach(function(t){n[t].check()})},t);e.forEach(function(t){return addEventListener(t,i)}),window.MutationObserver&&addEventListener("DOMContentLoaded",function(){new MutationObserver(i).observe(document.body,{attributes:!0,childList:!0,subtree:!0})});var u=function(t){if("string"==typeof t){var e=[].slice.call(document.querySelectorAll(t));return n.history.indexOf(t)>-1?n[t].elements=e:(n[t]=(0,f["default"])(e,r),n.history.push(t)),n[t]}};return u.offset=function(t){if(void 0===t)return r.offset;var e=function(t){return"number"==typeof t};return["top","right","bottom","left"].forEach(e(t)?function(e){return r.offset[e]=t}:function(n){return e(t[n])?r.offset[n]=t[n]:null}),r.offset},u.threshold=function(t){return"number"==typeof t&&t>=0&&t<=1?r.threshold=t:r.threshold},u.test=function(t){return"function"==typeof t?r.test=t:r.test},u.is=function(t){return r.test(t,r)},u.offset(0),u}};e["default"]=c()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r){n(this,t),this.options=r,this.elements=e,this.current=[],this.handlers={enter:[],exit:[]},this.singles={enter:[],exit:[]}}return r(t,[{key:"check",value:function(){var t=this;return this.elements.forEach(function(e){var n=t.options.test(e,t.options),r=t.current.indexOf(e),i=r>-1,o=n&&!i,u=!n&&i;o&&(t.current.push(e),t.emit("enter",e)),u&&(t.current.splice(r,1),t.emit("exit",e))}),this}},{key:"on",value:function(t,e){return this.handlers[t].push(e),this}},{key:"once",value:function(t,e){return this.singles[t].unshift(e),this}},{key:"emit",value:function(t,e){for(;this.singles[t].length;)this.singles[t].pop()(e);for(var n=this.handlers[t].length;--n>-1;)this.handlers[t][n](e);return this}}]),t}();e["default"]=function(t,e){return new i(t,e)}},function(t,e){"use strict";function n(t,e){var n=t.getBoundingClientRect(),r=n.top,i=n.right,o=n.bottom,u=n.left,f=n.width,s=n.height,c={t:o,r:window.innerWidth-u,b:window.innerHeight-r,l:i},a={x:e.threshold*f,y:e.threshold*s};return c.t>e.offset.top+a.y&&c.r>e.offset.right+a.x&&c.b>e.offset.bottom+a.y&&c.l>e.offset.left+a.x}Object.defineProperty(e,"__esModule",{value:!0}),e.inViewport=n},function(t,e){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,function(){return this}())},function(t,e,n){var r=n(5),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){function r(t,e,n){function r(e){var n=x,r=m;return x=m=void 0,E=e,w=t.apply(r,n)}function a(t){return E=t,j=setTimeout(h,e),M?r(t):w}function l(t){var n=t-O,r=t-E,i=e-n;return _?c(i,g-r):i}function d(t){var n=t-O,r=t-E;return void 0===O||n>=e||n<0||_&&r>=g}function h(){var t=o();return d(t)?p(t):void(j=setTimeout(h,l(t)))}function p(t){return j=void 0,T&&x?r(t):(x=m=void 0,w)}function v(){void 0!==j&&clearTimeout(j),E=0,x=O=m=j=void 0}function y(){return void 0===j?w:p(o())}function b(){var t=o(),n=d(t);if(x=arguments,m=this,O=t,n){if(void 0===j)return a(O);if(_)return j=setTimeout(h,e),r(O)}return void 0===j&&(j=setTimeout(h,e)),w}var x,m,g,w,j,O,E=0,M=!1,_=!1,T=!0;if("function"!=typeof t)throw new TypeError(f);return e=u(e)||0,i(n)&&(M=!!n.leading,_="maxWait"in n,g=_?s(u(n.maxWait)||0,e):g,T="trailing"in n?!!n.trailing:T),b.cancel=v,b.flush=y,b}var i=n(1),o=n(8),u=n(10),f="Expected a function",s=Math.max,c=Math.min;t.exports=r},function(t,e,n){var r=n(6),i=function(){return r.Date.now()};t.exports=i},function(t,e,n){function r(t,e,n){var r=!0,f=!0;if("function"!=typeof t)throw new TypeError(u);return o(n)&&(r="leading"in n?!!n.leading:r,f="trailing"in n?!!n.trailing:f),i(t,e,{leading:r,maxWait:e,trailing:f})}var i=n(7),o=n(1),u="Expected a function";t.exports=r},function(t,e){function n(t){return t}t.exports=n}])});
      
      </script></div> <!-- end of container div--> <script>
           var num_people_reached_with_one_currency_unit = 0;
      
      
      
      /*
      https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js
      https://github.com/js-cookie/js-cookie
       */
      !function(e){var n;if("function"==typeof define&&define.amd&&(define(e),n=!0),"object"==typeof exports&&(module.exports=e(),n=!0),!n){var t=window.Cookies,o=window.Cookies=e();o.noConflict=function(){return window.Cookies=t,o}}}(function(){function f(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var o in t)n[o]=t[o]}return n}function a(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(u){function c(){}function t(e,n,t){if("undefined"!=typeof document){"number"==typeof(t=f({path:"/"},c.defaults,t)).expires&&(t.expires=new Date(1*new Date+864e5*t.expires)),t.expires=t.expires?t.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(e){}n=u.write?u.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var r="";for(var i in t)t[i]&&(r+="; "+i,!0!==t[i]&&(r+="="+t[i].split(";")[0]));return document.cookie=e+"="+n+r}}function n(e,n){if("undefined"!=typeof document){for(var t={},o=document.cookie?document.cookie.split("; "):[],r=0;r<o.length;r++){var i=o[r].split("="),c=i.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var f=a(i[0]);if(c=(u.read||u)(c,f)||a(c),n)try{c=JSON.parse(c)}catch(e){}if(t[f]=c,e===f)break}catch(e){}}return e?t[e]:t}}return c.set=t,c.get=function(e){return n(e,!1)},c.getJSON=function(e){return n(e,!0)},c.remove=function(e,n){t(e,"",f(n,{expires:-1}))},c.defaults={},c.withConverter=e,c}(function(){})});
      
      
      
      
      function show_and_hide_element(element_to_be_shown, element_to_be_hidden) {
          $('#' + element_to_be_shown).show();
          $('#' + element_to_be_hidden).hide();
        }
      
      function show_advertising_system_info() {
          // todo: track function calls
          $('.advertising_more_info').toggle();
          $('.show_advertising_system_info_link').toggle();
        }
      
      function show_min_signatures_requirement_explanation() {
          $('.min_signatures_requirement_explanation').toggle();
          $('.show_min_signatures_requirement_explanation_link').toggle();
        }
      
      
      function get_ad_html(array_id) {
          var campaign = a_campaigns[array_id];
          var html = "<div id='ad_" + campaign.id + "' style='position: relative; padding: 1em; padding-top: 2em; margin-top: 1em; margin-bottom: 1em; background-color: #f8f8f8; border: 1px solid #ddd; '>" +
              "<span style='position: absolute; top: 0; left: 0; background-color: blue; color: white; padding: 0.3em; padding-right: 0.5em; border-bottom-right-radius: 5px 5px;'>Sponsored</span>" +
              "<a target='_top' href='/" + campaign.petition_current_path + "' class='petition_ad'" +
              "data-ad_campaign_id='" + campaign.id + "' data-petition_id='" + campaign.petition_id + "'><b style='font-size: 16px;'>" + campaign.petition_name + "</b></a>" +
              "<div class='petition_description'>" + campaign.petition_description + "</div>" +
              "</div>";
              return html;
      
            }
      
      function move_ad_campaign_element(campaign_id, visible_ad_number) {
          if ($("#a_campaign_" + campaign_id).length > 0) {
              console.log("Mainoksen elementti #a_campaign_" + campaign_id + " löytyi");
      
              if ($('#visible_ad_' + visible_ad_number).length > 0) {
                  console.log("Elementti #visible_ad_" + visible_ad_number + " löytyi. Siirretään mainos siihen.");
                  $('#visible_ad_' + visible_ad_number).append($("#a_campaign_" + campaign_id));
              } else {
                  console.log("Elementtiä #visible_ad_" + visible_ad_number + " ei löytynyt");
              }
            }   else {
              console.log("Mainoselementtiä #a_campaign_" + campaign_id + " ei löytynyt");
             }
        }
      
      function remove_ads_for_petitions_user_has_already_viewed() {
          for (var i in a_campaigns) {
              var ad_petition_id = a_campaigns[i].petition_id;
              if (localStorage["petition_" + ad_petition_id +  "_visits"]) {
                  //console.log("Käyttäjä on vieraillut adressissa " + ad_petition_id);
                  console.log("funktiossa remove_ads_for_petitions_user_has_already_viewed. Poistetaan mainos adressille "  + ad_petition_id + ", koska käyttäjä on vieraillut adressissa");
                  $(".advertisement_for_petition_" + ad_petition_id).remove();
                }
            }
        }
      
      
      
      function show_petition_ads() {
          // adblock detected
      
          //console.log('adblock detected');
          var ads_not_yet_seen = Array();
          var ads_already_shown_at_least_once = Array();
      
          var max_ad_views = 100;
      
      
      
      
          var num_times_ads_shown = Array(max_ad_views);
      
      
          for (var i = 0; i < max_ad_views; i++) {
              num_times_ads_shown[i] = new Array();
          }
      
      
          for (var i in a_campaigns) {
              var ad_petition_id = a_campaigns[i].petition_id;
      
      
              if (localStorage["petition_" + ad_petition_id +  "_visits"]) {
                  //console.log("Käyttäjä on vieraillut adressissa " + ad_petition_id);
      
                  console.log("Poistetaan mainos adressille "  + ad_petition_id + ", koska käyttäjä on vieraillut adressissa");
                  $(".advertisement_for_petition_" + ad_petition_id).remove();
              } else if (localStorage[ 'petition_' + ad_petition_id + '_ad_views']) {
                  var num_times_ad_shown_for_petition = localStorage[ 'petition_' + ad_petition_id + '_ad_views'];
                  //console.log(num_times_ad_shown_for_petition);
      
                  if (num_times_ad_shown_for_petition < max_ad_views) {
                      num_times_ads_shown[num_times_ad_shown_for_petition].push(a_campaigns[i].id);
      
                  } else {
                      console.log("Mainos adressille (id= " + ad_petition_id + ") on jo näytetty jo yli " + max_ad_views + " kertaa. Ei anneta erityisnäkyvyyttä tämän adressin mainokselle.");
      
                  }
      
      
                  /*if (localStorage[ 'petition_' + ad_petition_id + '_ad_views'] < 11) {
                      console.log("Käyttäjä on nähnyt adressin " + ad_petition_id + " mainoksen " + localStorage[ 'petition_' + ad_petition_id + '_ad_views'] + " kertaa. Lisättiin mainos taulukkoon ads_already_shown_at_least_once");
                      ads_already_shown_at_least_once.push( a_campaigns[i].id);
                  } else {
                      console.log("Adressin mainos " + ad_petition_id + " on jo näytetty jo yli 10 kertaa. Ei näytetä enää käyttäjälle.");
                  }*/
      
              } else {
                  num_times_ads_shown[0].push(a_campaigns[i].id);
      
                  console.log("Mainosta adressille " + ad_petition_id + " ei ole näytetty käyttäjälle kertaakaan.");
      
                  //console.log("Lisättiin taulukkoon ads_not_yet_seen arvo " + a_campaigns[i].id);
                  //ads_not_yet_seen.push(a_campaigns[i].id);
              }
          }
      
          var num_buy_advertising_ads = 0;
      
          if (false) {
              for (var i = 0; i < 3; i++) {
                  var visible_ad_number = i + 1;
      
                  if ($('#visible_ad_' + visible_ad_number).length) {
                      console.log('#visible_ad_' + visible_ad_number + " on olemassa");
                      // element exists
                  } else {
                      console.log('#visible_ad_' + visible_ad_number + " elementtiä ei löydy sivulta");
                      continue;
                  }
      
      
                  //var campaign_id = ads_already_shown_at_least_once.shift();
      
                  for (var a = 0; a < num_times_ads_shown.length; a++) {
                      var petition_ad_shown = false;
                      if (num_times_ads_shown[a].length >0) {
      
                          /*&& (visible_ad_number < 3 || window.innerWidth > 992)*/
      
                          if (current_page_type != 'browse petitions' && http_method != 'post') {
                              if ((is_adblock_on() || $('#visible_ad_' + visible_ad_number).attr("class") == 'petition_ad_spot') ) {
                                  //console.log(window.innerWidth);
                                  var campaign_id = num_times_ads_shown[a].shift();
      
                                  console.log("Näytetään mainospaikassa nro " + visible_ad_number + " mainoskampanjan " + campaign_id + " mainos adressille x. Mainosta tälle adressille on käyttäjälle näytetty aikaisemmin " + a + " kertaa ");
                                  move_ad_campaign_element(campaign_id, visible_ad_number);
                                  petition_ad_shown = true;
      
                                  break;
                              } else {
      
                              }
                          } else {
                              console.log("ei siirretä mainosta, koska ollaan adressien selaussivulla");
                          }
      
      
                      } else {
                          //console.log("Ei löytynyt yhtään mainosta, joka on näytetty " + a + " kertaa");;
      
                      }
                  }
      
                  if (false && petition_ad_shown == false) {
                      if (num_buy_advertising_ads == 0) {
                          console.log("Ei löytynyt yhtään adressimainosta mainospaikkaan nro " + visible_ad_number + ", joka voitaisiin näyttää, joten näytetään mainos adressin mainostilan ostamiseen");
                          $('#promote_petition').clone().appendTo('#visible_ad_' + visible_ad_number);
                          num_buy_advertising_ads++;
                      } else {
                          console.log("Ei löytynyt yhtään mainosta mainospaikkaan nro " + visible_ad_number + " ja täytemainos mainstilan ostamiseen on jo näytetty jo yhdessä mainospaikassa");
                      }
                  }
      
      
      
      
                  /*if (ads_not_yet_seen[i]) {
                      var campaign_id = ads_not_yet_seen[i];
                      console.log("Löytyi mainos " + campaign_id + ", jota ei ole vielä näytetty tälle käyttäjälle");
      
      
                      move_ad_campaign_element(campaign_id, visible_ad_number);
      
                  } else {
      
      
                      if (campaign_id) {
                          console.log("Näytetään mainos, jonka käyttäjä on jo nähnyt");
      
                          //$('#visible_ad_' + visible_ad_number).append($("#a_campaign_" + campaign_id));
                          move_ad_campaign_element(campaign_id, visible_ad_number);
      
                      } else {
      
                          if (num_buy_advertising_ads == 0) {
                              console.log("Ei löytynyt yhtään mainosta mainospaikkaan nro " + visible_ad_number + ", joka voitaisiin näyttää, joten näytetään mainos adressin mainostilan ostamiseen");
                              //$('#visible_ad_1').append($('#promote_petition'));
                              $('#promote_petition').clone().appendTo('#visible_ad_' + visible_ad_number);
                              num_buy_advertising_ads++;
                          } else {
                              console.log("Ei löytynyt yhtään mainosta mainospaikkaan nro " + visible_ad_number + ". ei näytetää mainoksia");
                          }
      
                      }
                  }*/
              }
          }
      
      
      
          if (current_page_type == 'browse petitions') {
              var num_times_ad_shown_max = 100;
          } else {
              var num_times_ad_shown_max = num_times_ads_shown.length;
          }
      
          var num_ads_moved = 0;
      
          for (var a = 0; a < num_times_ad_shown_max; a++) {
              if (num_times_ads_shown[a].length >0) {
                  var campaign_id;
      
                  while( (campaign_id = num_times_ads_shown[a].shift()) !== undefined ) {
      
                      $('#petition_ads div:empty').first().append($('#a_campaign_' + campaign_id));
                      num_ads_moved++;
                  }
              }
          }
      
          if (num_ads_moved == 0) {
              $('#petition_list_title').hide();
          }
      
          //$('#petition_ads_header').hide();
      
      
      }
      
      $('.fb-share-button-class a').click(function() {
      
          //alert(this.href);
      
          //return !window.open(this.href, 'PopUp', 'width=626,height=436');
          return !popupWindow(this.href, "facebook_share", window, 626, 436);
      
      });
      
      $('.fb-share-button-class').click(function() {
      
         var petition_href = $(this).find("a").attr('href');
      
          return !popupWindow(petition_href, "facebook_share", window, 626, 436);
      
      });
      
      //https://stackoverflow.com/questions/4068373/center-a-popup-window-on-screen
     /* function popupWindow(url, windowName, win, w, h) {
          const y = win.top.outerHeight / 2 + win.top.screenY - ( h / 2);
          const x = win.top.outerWidth / 2 + win.top.screenX - ( w / 2);
          return win.open(url, windowName, `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`);
      }*/
      
      $('.petition_ad').click(function() {
          //alert('testi');
          // current page type
          var current_url = window.location.href;
          var link_path = $(this).attr('href');
          var link_anchor = $(this).text();
          var petition_id = $(this).attr('data-petition_id');
          var campaign_id = $(this).attr('data-a_campaign_id');
          var a_view_id = a_views[campaign_id];
      
          //alert($(this).attr('href') + " " + $(this).text());
      
          var ad_distance_from_the_viewable_area_of_the_page_when_ad_clicked = $("#a_campaign_" + campaign_id).offset().top - $(window).scrollTop();
      
          // distance from the top of the page: $("li.test").offset().top
          // distance from the viewable area of the page: var viewableOffset = $("#li.test").offset().top - $(window).scrollTop();
          // page height, viewscreen height
      
      
          console.log("lähetetään kohta ajax-pyyntö");
          $.ajax({
              type: "POST",
              url: "save_a_click.php",
              data: "petition_id=" + petition_id + "&campaign_id=" + campaign_id + "&a_view_id=" + a_view_id
              + "&current_page_type=" + current_page_type + "&current_url=" + current_url + "&link_path="
              + link_path + "&link_anchor=" + link_anchor
              + "&page_view_id=" + page_view_id
      
              + "&ad_distance_from_the_viewable_area_of_the_page_when_ad_clicked=" + ad_distance_from_the_viewable_area_of_the_page_when_ad_clicked
              +  "&authenticity_token=" + authenticity_token,
              cache: false,
              success: function(result){
                  console.log("mainoskampanjan " + campaign_id + " klikkaus adressiin " + petition_id + " tallennettu onnistuneesti");
              }
          });
      
          // todo: localstorage
      
      
      });
      
      
      
      // todo: campaign_id, ad_id
      function track_ad_view(campaign_id, petition_id = false) {
          if (is_bot()) {
              console.log("Bot detected.");
              return 1;
          }
          
      
          //console.log("ollaan funktiossa track_ad_view");
      
          // alert('testi');
          //timer = window.setTimeout(function() {
          var current_url = window.location.href;
          var ad_height = $("#a_campaign_" + campaign_id).height();
          var ad_width = $("#a_campaign_" + campaign_id).width();
          var screen_width = screen.width;
          var screen_height = screen.height;
      
      
          if (is_adblock_on()) {
              var adblock = 1;
          } else {
              var adblock = 0;
          }
      
          // todo ad location, distance from the top of the page
          // petition_ads_list_top_of_main_content
          // some ads inside element #thank_you_page_petition_ads
      
          var ad_location = '?';
          // side_content_column
          if ($("#a_campaign_" + campaign_id).parents("#side_content_column").length > 0) {
              ad_location = 'side content column';
          } else if ($("#a_campaign_" + campaign_id).parents("#petition_ads_list_top_of_main_content").length > 0) {
              ad_location = 'top of main content';
          } else if ($("#a_campaign_" + campaign_id).parents("#petition_ads").length > 0) {
              ad_location = 'petition_list';
          } else if ($("#a_campaign_" + campaign_id).parents("#visible_ad_1").length > 0) {
              ad_location = 'ad_spot_1';
          } else if ($("#a_campaign_" + campaign_id).parents("#visible_ad_2").length > 0) {
              ad_location = 'ad_spot_2';
          } else if ($("#a_campaign_" + campaign_id).parents("#visible_ad_3").length > 0) {
              ad_location = 'ad_spot_3';
          }
      
          var ad_distance_from_the_top_of_the_page = $("#a_campaign_" + campaign_id).offset().top;
      
          // distance from the top of the page: $("li.test").offset().top
          // distance from the viewable area of the page: var viewableOffset = $("#li.test").offset().top - $(window).scrollTop();
          // page height, viewscreen height
      
      
      
      
          var key = 'petition_' + petition_id + '_ad_views';
          var num_times_ad_for_this_petition_has_already_been_shown = 0;
          if (localStorage[key]) {
              num_times_ad_for_this_petition_has_already_been_shown =  localStorage[key];
          }
      
      
          //console.log("Tämän adressin mainos on jo näytetty " + num_times_ad_for_this_petition_has_already_been_shown + " kertaa");
      
          console.log("Ilmoitetaan skriptillä mainosnäyttö adressista (id: " + petition_id + ", campaign_id: " + campaign_id + ", aiemmat näyttökerrat: " + num_times_ad_for_this_petition_has_already_been_shown + "). page_view_id: " + page_view_id + "; current_page_type: " + current_page_type + "; ad_location: " + ad_location);
      
      
          $.ajax({
              type: "POST",
              url: "save_view.php",
              data: "campaign_id=" + campaign_id + "&petition_id=" + petition_id + "&current_page_type=" +
              current_page_type + "&current_url=" + current_url + "&authenticity_token=" + authenticity_token +
              "&ad_height=" + ad_height + "&ad_width=" + ad_width + "&screen_height=" + screen_height + "&screen_width=" + screen_width
              + "&page_view_id=" + page_view_id
              + "&adblock=" + adblock
              + "&ad_location=" + ad_location
              + "&ad_distance_from_the_top_of_the_page=" + ad_distance_from_the_top_of_the_page
      
              +  "&id_of_petition_shown_in_this_page=" + id_of_petition_shown_in_this_page + "&num_times_ad_for_this_petition_has_already_been_shown=" + num_times_ad_for_this_petition_has_already_been_shown,
              cache: false,
              success: function(result){
                  console.log("Tallennettiin onnistuneesti mainosnäyttö id:llä:  " + result.trim())
      
                  a_views[campaign_id] = result.trim();
      
                  // todo: save ad view information to localstorage
                  localStorage['petition_' + petition_id + '_last_ad_view'] = new Date().getTime();
      
      
                  if (localStorage[key]) {
                      var old_value = localStorage[key];
                      localStorage[key]++;
                      console.log("Kasvatettiin localStoragessa avaimen " + key + " arvoa arvosta " + old_value + " arvoon " + localStorage[key]);
                  } else {
                      localStorage[key] = 1;
                  }
      
      
      
      
              }
          });
      
          //console.log('Hovered for 1 seconds');
          //}, 5000);
      
          // todo: localstorage
        }
      
      function is_adblock_on() {
          if (adblock_used()) {
              return true;
            }  else {
              return false;
            }
      
        }
      
      function adblock_used() {
          if (typeof ad_blocker_file_loaded !== 'undefined') {
              return false;
          } else {
              return true;
          }
        }
      
      function adblock_used_old() {
          if ($('#test_ad').is(":hidden") || $('#ad').is(":hidden")) {
              return true;
          } else {
              return false;
          }
      }
      
      
      
      
      function cookie_consent_modal_is_visible_to_visitor() {
      
          //cookie_consent_banner_shown
      
          // Cookie Settings, http://html-tuts.com/demo/set-increment-cookie/
          var initCookie = 1, expirationDays = 100;
          var cookieName = "num_times_cookie_consent_banner_shown";
          var getCookie = Cookies.get(cookieName);
      
      // Under the Hood
          if (getCookie == null) {
              Cookies.set(cookieName, initCookie, { expires: expirationDays });
              console.log('Cookie ' + cookieName + ' set to value 1');
          } else {
              if (getCookie >= initCookie) {
                  getCookie++;
                  Cookies.set(cookieName, getCookie, { expires: expirationDays });
                  console.log('Cookie ' + cookieName + ' incremented. Value is ' + getCookie);
              }
          }
      
          const currentDate = new Date();
      
          var MyDate = new Date();
          var MyDateString;
      
          dateString = MyDate.getFullYear() + '-' + ('0' + (MyDate.getMonth()+1)).slice(-2) + '-' + ('0' + MyDate.getDate()).slice(-2);
      
          Cookies.set('cookie_consent_banner_shown_last_time', dateString, { expires: 100 });
      
      
          save_event_to_log("Cookie consent banner has been shown to the visitor");
      }
      
      function save_event_to_log(message) {
          // todo: save all events with one ajax request
      
          var current_url = window.location.href;
          var screen_width = screen.width;
          var screen_height = screen.height;
      
          if (is_adblock_on()) {
              var adblock = 1;
          } else {
              var adblock = 0;
          }
      
          // milliseconds
          var time_until_this_function_called = Date.now()-timerStart;
      
          $.ajax({
              type: "POST",
              url: "save_event.php",
              data: "message=" + message
                  + "&screen_height=" + screen_height
                  + "&screen_width=" + screen_width
                  + "&authenticity_token=" + authenticity_token,
              cache: false,
              success: function (result) {
                  console.log("Event saved, message: " + message + "; result: " + result.trim());
      
              }
          });
      
      }
      
      function is_bot(){
          var botPattern = "(googlebot\/|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)";
          var re = new RegExp(botPattern, 'i');
          var userAgent = navigator.userAgent;
          if (re.test(userAgent)) {
              return true;
          }else{
              return false;
          }
      }
      
      function save_page_view() {
      
          if (is_bot()) {
              console.log("Bot detected.");
              return 1;
          }
      
          // alert('testi');
          //timer = window.setTimeout(function() {
          var current_url = window.location.href;
          var screen_width = screen.width;
          var screen_height = screen.height;
      
      
          if (is_adblock_on()) {
              var adblock = 1;
          } else {
              var adblock = 0;
          }
      
      
          // milliseconds
          var time_until_dom_ready = Date.now()-timerStart;
      
          var num_petition_ads_on_this_page = $('#petition_ads .ad').length; //$('.ad').length;
      
          console.log("Funktiossa save_page_view. adressimainosten määrä: " + num_petition_ads_on_this_page + ". kutsutaan seuraavaksi ajax-funktiota.");
      
      
      
          $.ajax({
              type: "POST",
              url: "save_page_view.php",
              data: "petition_id=" + page_petition_id
              + "&current_page_type=" + current_page_type
              + "&page_request_type=" + http_method
              + "&current_url=" + current_url
              + "&authenticity_token=" + authenticity_token
              + "&screen_height=" + screen_height
              + "&screen_width=" + screen_width
              + "&adblock=" + adblock
              + "&processing_time_on_server_side=" + processing_time_on_server_side
              + "&num_petition_ads_on_this_page=" + num_petition_ads_on_this_page
              + "&time_until_dom_ready=" + time_until_dom_ready,
              cache: false,
              success: function(result){
                  console.log("Sivulataus tallennettu id:llä: " + result.trim());
      
                  page_view_id = result.trim();
      
      
                  $(window).on("load",function() {
                      save_page_fully_loaded_information();
                      console.log("Time until everything loaded: ", Date.now()-timerStart);
      
                      /*
                       if ($('#visible_ad_1').length > 0 || $('#visible_ad_2').length > 0 || $('#visible_ad_3').length > 0) {
                       if ($('#visible_ad_1').height() > 49 || $('#visible_ad_2').height() > 49 || $('#visible_ad_3').height() > 49) {
                       console.log("Page is fully loaded. It seems Adsense ads are shown normally. Num elements in visible_ad_1 elements: " + $('#visible_ad_1').length + ". Elementin leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
      
                       } else {
                       console.log("Page is fully loaded. It seems AdSense ads are blocked. Elementin visible_ad_1: leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
                       //remove_ads_for_petitions_user_has_already_viewed();
      
                       }
                       } */
      
                  });
      
                  window.addEventListener("beforeunload", function (event) {
                      console.log("unload");
                      visitor_leaves_page();
      
                      // Most browsers.
                      //event.preventDefault();
      
                      // Chrome/Chromium based browsers still need this one.
                      //event.returnValue = "\o/";
                  });
      
              }
          });
      
          // ajax-pyyntö on asynkroninen, joten page_view_id:llä ei ole varmuudella arvoa.
          //console.log("Funktiossa save_page_view. rivi ajax-pyynnön jälkeen. page_view_id: " + page_view_id);
      
      
          //console.log('Hovered for 1 seconds');
          //}, 5000);
      
          // todo: localstorage
      
        }
      
      function save_page_fully_loaded_information() {
          var time_until_page_fully_loaded = Date.now()-timerStart;
          console.log("Funktiossa save_page_fully_loaded_information. ");
      
          if (typeof page_view_id !== "undefined") {
      
              $.ajax({
                  type: "POST",
                  url: "update_page_view.php",
                  data: "page_view_id=" + page_view_id + "&time_until_page_fully_loaded="
                  + time_until_page_fully_loaded
                  + "&authenticity_token=" + authenticity_token,
                  cache: false,
                  success: function (result) {
                      console.log("Kenttä time_until_page_fully_loaded päivitetty taulussa page_views");
                      ;
      
                  }
              });
          } else {
      
          }
      }
      
      function visitor_leaves_page() {
          var time_spent_on_page = Date.now()-timerStart;
          console.log("Funktiossa visitor_leaves_page. ");
      
          if (typeof page_view_id !== "undefined") {
              $.ajax({
                  type: "POST",
                  url: "update_table_page_view_column_time_spent_on_page.php",
                  data: "page_view_id=" + page_view_id + "&time_spent_on_page="
                      + time_spent_on_page
                      + "&authenticity_token=" + authenticity_token,
                  cache: false,
                  success: function(result){
                      console.log("Kenttä time_spent_on_page päivitetty taulussa page_views");;
      
                  }
              });
          } else {
              console.log("page_view_id:n arvoa ei asetettu, joten ei voida päivittää tietoa miten kauan sivulla viivyttiin");
          }
      }
      
      function getBootstrapDeviceSize() {
          return $('#users-device-size').find('div:visible').first().attr('id');
      }
      
      
      /*
       Code included inside $( document ).ready() will only run once the page Document Object Model (DOM) is ready for JavaScript code to execute.
       */
      $(document).ready(function(){
          //$('.pagination li').addClass('page-item');
          //$('.pagination li a').addClass('page-link');
      
          //$('.dropdown-toggle').dropdown();
      
          $('.paginator-select-page').change(function() {
              //alert("testi");
              document.location = $(this).val();
          });
      
      
      
          save_page_view();
      
      
      
          $("input[name='ad_budget']").click(
              function()
              {
                  var ad_budget = $(this).filter(':checked').val(); //$("input[name='ad_budget']:checked").val();
      
                  $("input[name=ad_budget][value=" + ad_budget + "]").prop("checked", true);
      
                  var num_people_to_reach = ad_budget * num_people_reached_with_one_currency_unit;
      
                  $('.num_people_to_reach').text(num_people_to_reach);
      
              }
          );
      
      
          remove_ads_for_petitions_user_has_already_viewed();
      
          var is_adblock_used;
      
          if (adblock_used()) {
              is_adblock_used = 1;
              console.log("adblock on päällä");
              //console.log("Dom is loaded. It seems Adsense ads are shown normally. Num elements in visible_ad_1 elements: " + $('#visible_ad_1').length + ". Elementin leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
          } else {
              is_adblock_used = 0;
              console.log("adblock ei ole päällä");
              // console.log("Dom is loaded. It seems Adsense ads are shown normally. Num elements in visible_ad_1 elements: " + $('#visible_ad_1').length + ". Elementin leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
          }
      
      
          /*
          if ($('#visible_ad_1').length > 0 || $('#visible_ad_2').length > 0 || $('#visible_ad_3').length > 0) {
              if ($('#visible_ad_1').height() > 49 || $('#visible_ad_2').height() > 49 || $('#visible_ad_3').height() > 49) {
                  console.log("Dom is loaded. It seems Adsense ads are shown normally. Num elements in visible_ad_1 elements: " + $('#visible_ad_1').length + ". Elementin leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
      
              } else {
                  console.log("Dom is loaded. It seems AdSense ads are blocked. Elementin visible_ad_1: leveys:  " + $('#visible_ad_1').width() + ", korkeus: " + $('#visible_ad_1').height());
      
                  //remove_ads_for_petitions_user_has_already_viewed();
      
              }
          } */
      
      
      
      
      
      
      
      
          console.log("Time until DOMready: ", Date.now()-timerStart);
      
          /*if (adblock_used()) {
          }*/
      
          show_petition_ads();
      
          $('input[name=adblock]').val(is_adblock_used);
      
      
          //$("input").attr("type", 'hidden').val(is_adblock_used).val()).appendTo('form');
      
          // $("input").attr("type", 'hidden').val(1).appendTo('form');
      
      
          console.log("page type: " + current_page_type + "; show_adsense_ads: " + show_adsense_ads);
          if (current_page_type == 'browse petitions' ||  current_page_type == 'home page' || is_adblock_used || show_adsense_ads == 0) {
              var num_petition_ads_on_this_page = $('#petition_ads .ad').length;
      
              var grid_size = getBootstrapDeviceSize();
      
              console.log("grid size: " + grid_size + "; num_petition_ads_on_this_page: " + num_petition_ads_on_this_page);
      
              if (http_method == 'get') {
      
                  if (num_petition_ads_on_this_page == undefined) {
                      console.log("Mainoksia ei siirretä, koska muuttujan num_petition_ads_on_this_page arvo on undefined");
      
                  } else if (cookie_consent_modal_shown == true) {
                      console.log("Mainoksia ei siirretä, koska tällä sivulatauksella näytetään evästekysely");
      
                  }else if (num_petition_ads_on_this_page > 0) {
                      // sivupalkkiin siirto, isot ruudut
                      if ($('#side_content_column').length >0 && (is_adblock_used || show_adsense_ads == 0) && (grid_size == 'md' || grid_size == 'lg')) {
                          console.log("Siirretään adressimainokset vasempaan palkkiin");
                          $('#side_content_column').prepend($('#petition_ads').css('max-width', '300px')); //.css('border', '1px solid red'));
                          //$('#side_content_column').prepend(num_petition_ads_on_this_page);
                          $('#petition_ads').prepend('<h2 id="petitions_promoted_by_other_users">' + petitions_promoted_by_other_users + '</h2>');
      
      
                          //$('#petition_ads .ad').first().prependTo('#main');
                      }
                      /*
                      current_page_type != 'create a petition'
                            &&  current_page_type != 'contact'
                              &&  current_page_type != 'login'
                              &&  current_page_type != 'register'
                              &&  current_page_type != 'login-register'
                       */
                      // mainoksien siirto ylös
                      else if (
      
                          (current_page_type == 'home page' ||
                              current_page_type == 'browse petitions' ||
                              current_page_type == 'signatures' ||
                              current_page_type == 'announcements' ||
                              current_page_type == 'sign a petition' ||
                              current_page_type == 'stats'
      
      
      
      
                          ) /*&& (
                          (
                              current_page_type != 'sign a petition'
                              || $('#signature_form').length > 0)
                              &&
                              (
                                  grid_size == 'sm' || grid_size == 'xs')
                                  ||
                                  (
                                      $('#side_content_column').length >0 && (grid_size == 'md'
                                      || grid_size == 'lg') && (current_page_type != 'home page'
                                      || num_sessions > 2
                                  )
                              )
                          )*/
                      )
                      // todo: if confirmed == false
                      // if (current_page_type != 'home page' || num_sessions > 2)
                      {
                          //if ( ((is_adblock_used || show_adsense_ads == 0) && adsense_page_level_ads_enabled != true)) {
                          if ( ((is_adblock_used || show_adsense_ads == 0) && adsense_page_level_ads_enabled != true)) {
      
                              console.log("siirretään adressimainoksia (max 3) sivun yläosaan. is_adblock_used: " + is_adblock_used + "; show_adsense_ads: " + show_adsense_ads + "; adsense_page_level_ads_enabled: " + adsense_page_level_ads_enabled);
                              $('#main').prepend($('#petition_ads_list_top_of_main_content'));
      
                              $('#petition_ads_list_top_of_main_content').show();
      
                              $('#petition_ads_list_top_of_main_content').prepend('<h2>' + petitions_promoted_by_other_users + '</h2>');
                              $('#petition_ads .ad').first().appendTo('#petition_ads_list_top_of_main_content');
                              $('#petition_ads .ad').first().appendTo('#petition_ads_list_top_of_main_content');
                              $('#petition_ads .ad').first().appendTo('#petition_ads_list_top_of_main_content');
                          } else {
                              console.log("Mainoksia ei siirretä, koska adsense-mainoksia ehkä näkyvissä. is_adblock_used: " + is_adblock_used + "; show_adsense_ads: " + show_adsense_ads + "; adsense_page_level_ads_enabled: " + adsense_page_level_ads_enabled);
      
                          }
      
      
      
      
                          // todo: check if any ads left and if not then hide the headline
      
                          //$('#petition_ads_list_top_of_main_content').prepend(grid_size);
      
                          // todo: yksittäinen adressimainos sivun yläosaan
                      } else {
                          console.log("Mainokska ei siirretä2");
                          console.log("adsense_page_level_ads_enabled: " + adsense_page_level_ads_enabled
                              + "; is_adblock_used: " + is_adblock_used
                              + "; http_method: " + http_method + "; num_petition_ads_on_this_page = "
                              + num_petition_ads_on_this_page + "; current_page_type: "
                              + current_page_type + "; grid_size: " + grid_size);
      
                      }
      
      
                  } else if (num_petition_ads_on_this_page == 0) {
                      console.log("Adressimainoksia ei ole yhtään");
                  }
              }
      
      
      
              if (http_method == 'get') {
      
              }
      
            //  $('#main').prepend("num petition ads: " + num_petition_ads_on_this_page);
      
              //$('#main').prepend("jotain");
          }
      
      
          // todo: or signature just confirmed
          if (current_page_type == 'sign a petition' && http_method == 'post') {
              var num_ads_inside_petition_ads_div = $('#petition_ads .ad').length;
      
      
      
              if (num_ads_inside_petition_ads_div > 0) {
                  console.log("Siirretään adressimainokset #main-divin sisälle footerista");
      
                 $('#thank_you_page_petition_ads').append('<h2>' + petitions_promoted_by_other_users + '</h2>');
                  $('#thank_you_page_petition_ads').append($('#petition_ads'));
              } else {
                  console.log("Adressimainoksia ei ollut yhtään, joten adressimainoksia ei tarvitse siirtää #main-divin sisälle");
              }
      
          } else if ($('#footer #petition_ads').length > 0) {
              $('#petition_ads').prepend('<h2>' + petitions_promoted_by_other_users + '</h2>');
          }
      
          if ($('#petition_ads .ad').length == 0) {
              console.log("footerissa ei ole yhtään mainosta enää, joten piilotetaan mainoksien otsikko");
              $('#petition_ads').hide();
          }
      
      
      
          console.log("num petition ads: " + num_petition_ads_on_this_page);
      
        console.log("adblock: " + is_adblock_used);
          $('#main').prepend($('#user_links'));
          //$('#main').prepend($('#users-device-size'));
      
      
      
      });
      
      // #petition_list  .petition_ad_link, a.petition_link
      $('.petition_ad_link, a.petition_link').click(function() {
          //alert('testi');
          // current page type
          var current_url = window.location.href;
          var link_path = $(this).attr('href');
          var link_anchor = $(this).text();
          var petition_id = $(this).attr('data-petition_id');
      
          //alert($(this).attr('href') + " " + $(this).text());
      
          $.ajax({
              type: "POST",
              url: "track_click.php",
              data: "petition_id=" + petition_id + "&current_page_type=" + current_page_type + "&current_url=" + current_url + "&link_path=" + link_path + "&link_anchor=" + link_anchor,
              cache: false,
              success: function(result){
      
              }
          });
      
      
      });
      
      
      $('input[type=text],input[type=password],textarea').blur(function(){
          $(this).parent().removeClass('highlight')
      });
      
      
      
      var is_registration_form_loaded = false;
      
      $('#register_link').click(function(e) {
          $('#registrationForm').toggle();
      
          if (is_registration_form_loaded == false) {
              $('#registrationForm').load('/register.php?is_embedded=1&backURL=' + window.location);
              is_registration_form_loaded = true;
          }
      
          return false;
      
      });
      
      $('#i_accept_tos_and_privacy_policy').click(function() {
          if ($('#email').val() == '') {
              $('#captcha').show();
          }
      
      });
      
      
      $('#register_link_2').click(function(e) {
          $('#registrationForm').toggle();
      
          if (is_registration_form_loaded == false) {
              $('#registrationForm').load('/register.php?is_embedded=1&backURL=/');
              is_registration_form_loaded = true;
          }
      
          return false;
      
      });
      
      var user_information = "screen.width: " + screen.width   + " screen.height: " + screen.height;
      
      
      $('input[name=user_information]').val(user_information);
      $('input[name=screen_width]').val(screen.width);
      $('input[name=screen_height]').val(screen.height);
      
      
      $(function () {
          $('#show_more_features').click(function () {
              $('#features li:hidden').show();
              $('#show_more_features').hide();
      
          });
      });
    
      
      // auto grow textarea: http://www.technoreply.com/wp-content/uploads/2010/05/jquery.autogrowtextarea.js
      //Private variables
      var colsDefault = 0;
      var rowsDefault = 0;
      //var rowsCounter = 0;
      
      //Private functions
      function setDefaultValues(txtArea)
      {
          colsDefault = txtArea.cols;
          rowsDefault = txtArea.rows;
          //rowsCounter = document.getElementById("rowsCounter");
      }
      
      function bindEvents(txtArea)
      {
          txtArea.onkeyup = function() {
              grow(txtArea);
          }
      }
      
      //Helper functions
      function grow(txtArea)
      {
      
          //alert('jotain');
      
          var linesCount = 0;
          var lines = txtArea.value.split('\\n');
      
          for (var i=lines.length-1; i>=0; --i)
          {
              linesCount += Math.floor((lines[i].length / colsDefault) + 1);
          }
      
          if (linesCount >= rowsDefault)
              txtArea.rows = linesCount + 1;
          else
              txtArea.rows = rowsDefault;
          //rowsCounter.innerHTML = linesCount + " | " + txtArea.rows;
      }
      
      //Public Method
      jQuery.fn.autoGrow = function(){
          return this.each(function(){
              setDefaultValues(this);
              bindEvents(this);
          });
      };
      </script></div>  



 </body>
</html>